import numpy as np
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.model_selection import train_test_split

# 데이타 수집/분류
x = np.array([1,2,3,4,5])
y = np.array([1,2,3,4,5])

x_train, x_test, y_train, y_test = train_test_split(
    x, y,
    train_size = 0.7,
    test_size = 0.3,
    shuffle = True,
    random_state = 123
)

print ("x_train", x_train)
print ("x_test", x_test)
print ("y_train", y_train)
print ("y_test", y_test)

# 모델
model = Sequential()
model.add(Dense(3, input_dim=1))
model.add(Dense(5))
model.add(Dense(3))
model.add(Dense(1))

#컴파일/훈련
model.compile(loss = "mse", optimizer = "adam")
model.fit(x_train, y_train, epochs = 100, batch_size=5)

#평가/예측
loss = model.evaluate(x_test, y_test)
print("평가데이타: ", loss)

result = model.predict([11])
print("예측값: ", result)


